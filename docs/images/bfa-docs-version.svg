<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill-opacity="1" color-rendering="auto" color-interpolation="auto" text-rendering="auto" stroke="black" stroke-linecap="square" width="982" stroke-miterlimit="10" shape-rendering="auto" stroke-opacity="1" fill="black" stroke-dasharray="none" font-weight="normal" stroke-width="1" height="737" font-family="'Dialog'" font-style="normal" stroke-linejoin="miter" font-size="12px" stroke-dashoffset="0" image-rendering="auto">
  <!--Generated by ySVG 2.5-->
  <defs id="genericDefs"/>
  <g>
    <defs id="defs1">
      <clipPath clipPathUnits="userSpaceOnUse" id="clipPath1">
        <path d="M0 0 L982 0 L982 737 L0 737 L0 0 Z"/>
      </clipPath>
      <clipPath clipPathUnits="userSpaceOnUse" id="clipPath2">
        <path d="M-36 47 L946 47 L946 784 L-36 784 L-36 47 Z"/>
      </clipPath>
    </defs>
    <g fill="white" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="translate(36,-47)" stroke="white">
      <rect x="-36" width="982" height="737" y="47" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g fill="aqua" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="aqua">
      <rect x="16.25" width="309.75" height="132" y="549" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="16.25" width="309.75" height="132" y="549" clip-path="url(#clipPath2)"/>
      <text x="144.1602" xml:space="preserve" y="540.1699" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Keycloak</text>
    </g>
    <g fill="rgb(153,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(153,204,0)">
      <rect x="819" width="112" height="67" y="379" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="819" width="112" height="67" y="379" clip-path="url(#clipPath2)"/>
      <text x="862.6104" xml:space="preserve" y="416.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">UCS</text>
    </g>
    <g fill="rgb(255,153,204)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,153,204)">
      <rect x="480" width="249" height="322" y="359" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="480" width="249" height="322" y="359" clip-path="url(#clipPath2)"/>
      <text x="549.6475" xml:space="preserve" y="350.1699" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Handler Container</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="522" width="112" height="89" y="566" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="522" width="112" height="89" y="566" clip-path="url(#clipPath2)"/>
      <text x="545.1553" xml:space="preserve" y="614.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Poll Events</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="522" width="112" height="49" y="487" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="522" width="112" height="49" y="487" clip-path="url(#clipPath2)"/>
      <text x="546.2422" xml:space="preserve" y="515.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Conditions</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="522" width="112" height="89" y="378" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="522" width="112" height="89" y="378" clip-path="url(#clipPath2)"/>
      <text x="536.3926" xml:space="preserve" y="398.7168" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Actions, e.g. </text>
      <text x="536.3926" xml:space="preserve" y="412.6855" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- send mail</text>
      <text x="536.3926" xml:space="preserve" y="426.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- block IP</text>
      <text x="536.3926" xml:space="preserve" y="440.623" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- block device</text>
      <text x="536.3926" xml:space="preserve" y="454.5918" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- disable user</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="40.75" width="256" height="30" y="632.5" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="40.75" width="256" height="30" y="632.5" clip-path="url(#clipPath2)"/>
      <text x="76.4268" xml:space="preserve" y="651.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Keycloakinternal BF-Protection</text>
    </g>
    <g fill="rgb(255,153,204)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,153,204)">
      <rect x="117.7333" width="208.2667" height="89" y="409.6558" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="117.7333" width="208.2667" height="89" y="409.6558" clip-path="url(#clipPath2)"/>
    </g>
    <g fill="white" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="white">
      <rect x="159.7483" width="100.1699" height="17.9688" y="387.687" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" font-family="sans-serif" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <text x="161.7483" xml:space="preserve" y="400.8257" clip-path="url(#clipPath2)" stroke="none">Proxy Container</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="40.75" width="256" height="38" y="581" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="40.75" width="256" height="38" y="581" clip-path="url(#clipPath2)"/>
      <text x="108.1904" xml:space="preserve" y="597.1699" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Keycloak Auth Flow:</text>
      <text x="62.6953" xml:space="preserve" y="611.1387" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">decisions based on LDAP attributes</text>
    </g>
    <g fill="rgb(255,102,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,102,0)">
      <rect x="16.25" width="107" height="49" y="62.3115" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="16.25" width="107" height="49" y="62.3115" clip-path="url(#clipPath2)"/>
      <text x="29.6074" xml:space="preserve" y="90.9658" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">User/Browser</text>
    </g>
    <g fill="aqua" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="aqua">
      <rect x="16.25" width="309.75" height="142.2453" y="206.5468" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="16.25" width="309.75" height="142.2453" y="206.5468" clip-path="url(#clipPath2)"/>
      <text x="159.4165" xml:space="preserve" y="201.7167" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Reverse Proxy</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="40.75" width="258.375" height="94.307" y="233.0046" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="40.75" width="258.375" height="94.307" y="233.0046" clip-path="url(#clipPath2)"/>
      <text x="48.8066" xml:space="preserve" y="256.3748" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - Terminate HTTPS</text>
      <text x="48.8066" xml:space="preserve" y="270.3436" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - Set X-FORWARDED-FOR HTTP Header</text>
      <text x="48.8066" xml:space="preserve" y="284.3123" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - Forward Login Actions requests to</text>
      <text x="48.8066" xml:space="preserve" y="298.2811" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">    proxy-container and any other</text>
      <text x="48.8066" xml:space="preserve" y="312.2498" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">    requests directly to Keylcoak</text>
    </g>
    <g fill="rgb(255,204,0)" text-rendering="geometricPrecision" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke="rgb(255,204,0)">
      <rect x="141.045" width="158.08" height="67" y="421.8264" clip-path="url(#clipPath2)" stroke="none"/>
    </g>
    <g text-rendering="geometricPrecision" stroke-miterlimit="1.45" shape-rendering="geometricPrecision" transform="matrix(1,0,0,1,36,-47)" stroke-linecap="butt">
      <rect fill="none" x="141.045" width="158.08" height="67" y="421.8264" clip-path="url(#clipPath2)"/>
      <text x="152.3448" xml:space="preserve" y="445.512" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- forward requests</text>
      <text x="152.3448" xml:space="preserve" y="459.4807" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- enforce posted rules,</text>
      <text x="152.3448" xml:space="preserve" y="473.4495" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">- delete expired rules</text>
      <path fill="none" d="M326.0059 632.2174 L514.0071 632.2174" clip-path="url(#clipPath2)"/>
      <path d="M522.0071 632.2174 L510.0071 627.2174 L513.0071 632.2174 L510.0071 637.2174 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <text x="345.1179" xml:space="preserve" y="632.4498" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none"> </text>
      <text x="345.1179" xml:space="preserve" y="646.4186" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Event List with:</text>
      <text x="345.1179" xml:space="preserve" y="660.3873" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - IP</text>
      <text x="345.1179" xml:space="preserve" y="674.3561" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - Device ID</text>
      <text x="345.1179" xml:space="preserve" y="688.3248" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - Timestamp</text>
      <text x="345.1179" xml:space="preserve" y="702.2936" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">  - Type</text>
      <path fill="none" d="M522 610.5 L333.979 610.5" clip-path="url(#clipPath2)"/>
      <path d="M325.979 610.5 L337.979 615.5 L334.979 610.5 L337.979 605.5 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="385.751" y="601.5156" clip-path="url(#clipPath2)" fill="white" width="76.498" height="17.9688" stroke="none"/>
      <text x="387.751" xml:space="preserve" y="614.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">GET /events</text>
      <path fill="none" d="M578 566 L578 544" clip-path="url(#clipPath2)"/>
      <path d="M578 536 L573 548 L578 545 L583 548 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <path fill="none" d="M578 487 L578 475" clip-path="url(#clipPath2)"/>
      <path d="M578 467 L573 479 L578 476 L583 479 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <path fill="none" d="M634.0245 412.5 L811 412.5" clip-path="url(#clipPath2)"/>
      <path d="M819 412.5 L807 407.5 L810 412.5 L807 417.5 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="684.2637" y="396.5312" clip-path="url(#clipPath2)" fill="white" width="84.4727" height="31.9375" stroke="none"/>
      <text x="694.6895" xml:space="preserve" y="409.6699" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Block User</text>
      <text x="686.2637" xml:space="preserve" y="423.6387" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">via UDM Rest</text>
      <path fill="none" d="M241.2293 498.6582 L241.2293 540.9626" clip-path="url(#clipPath2)"/>
      <path d="M241.2293 548.9626 L246.2293 536.9626 L241.2293 539.9626 L236.2293 536.9626 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <path fill="none" d="M40.75 600 L-20.25 600 L-20.25 759.5 L875 759.5 L875 454" clip-path="url(#clipPath2)"/>
      <path d="M875 446 L870 458 L875 455 L880 458 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="372.2217" y="750.5156" clip-path="url(#clipPath2)" fill="white" width="35.3711" height="17.9688" stroke="none"/>
      <text x="374.2217" xml:space="preserve" y="763.6543" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">LDAP</text>
      <path fill="none" d="M69.75 111.3115 L69.75 198.4985" clip-path="url(#clipPath2)"/>
      <path d="M69.75 206.4985 L74.75 194.4985 L69.75 197.4985 L64.75 194.4985 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="24.9092" y="149.9448" clip-path="url(#clipPath2)" fill="white" width="89.6816" height="17.9688" stroke="none"/>
      <text x="26.9092" xml:space="preserve" y="163.0835" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">Login Request</text>
      <path fill="none" d="M296.11 348.8262 L296.11 401.6751" clip-path="url(#clipPath2)"/>
      <path d="M296.11 409.6751 L301.11 397.6751 L296.11 400.6751 L291.11 397.6751 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="283.8386" y="370.2395" clip-path="url(#clipPath2)" fill="white" width="84.543" height="17.9688" stroke="none"/>
      <text x="285.8386" xml:space="preserve" y="383.3782" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">/login-action*</text>
      <path fill="none" d="M74.5149 348.7967 L74.5149 540.981" clip-path="url(#clipPath2)"/>
      <path d="M74.5149 548.981 L79.5149 536.981 L74.5149 539.981 L69.5149 536.981 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="-8.7868" y="422.6563" clip-path="url(#clipPath2)" fill="white" width="106.6035" height="17.9688" stroke="none"/>
      <text x="-6.7868" xml:space="preserve" y="435.795" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">non login actions</text>
      <path fill="none" d="M521.9834 455.3264 L307.125 455.3264" clip-path="url(#clipPath2)"/>
      <path d="M299.125 455.3264 L311.125 460.3264 L308.125 455.3264 L311.125 450.3264 Z" clip-path="url(#clipPath2)" stroke="none"/>
      <rect x="376.0869" y="446.342" clip-path="url(#clipPath2)" fill="white" width="68.9512" height="17.9688" stroke="none"/>
      <text x="378.0869" xml:space="preserve" y="459.4807" clip-path="url(#clipPath2)" font-family="sans-serif" stroke="none">POST rules</text>
    </g>
  </g>
</svg>
